<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3.4 Numerical integration to simulate continuous time | The Complex Systems Approach to Behavioural Science</title>
  <meta name="description" content="3.4 Numerical integration to simulate continuous time | The Complex Systems Approach to Behavioural Science. This book is a practical guide to basic theory, models, methods and analyses that can be used to study human physiology, behaviour and cognition from the perspective of Complex Adaptive Systems and Networks." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="3.4 Numerical integration to simulate continuous time | The Complex Systems Approach to Behavioural Science" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/foundations.png" />
  <meta property="og:description" content="3.4 Numerical integration to simulate continuous time | The Complex Systems Approach to Behavioural Science. This book is a practical guide to basic theory, models, methods and analyses that can be used to study human physiology, behaviour and cognition from the perspective of Complex Adaptive Systems and Networks." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3.4 Numerical integration to simulate continuous time | The Complex Systems Approach to Behavioural Science" />
  
  <meta name="twitter:description" content="3.4 Numerical integration to simulate continuous time | The Complex Systems Approach to Behavioural Science. This book is a practical guide to basic theory, models, methods and analyses that can be used to study human physiology, behaviour and cognition from the perspective of Complex Adaptive Systems and Networks." />
  <meta name="twitter:image" content="images/foundations.png" />

<meta name="author" content="Fred Hasselman" />


<meta name="date" content="2019-01-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="implementing-iterative-functions.html"/>
<link rel="next" href="deterministic-chaos.html"/>
<script src="libs/header-attrs-2.6/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">The Complex Systems Approach</a></strong></li>

<li class="divider"></li>
<li><a href="index.html#course-guide"><strong>Course Guide</strong></a></li>
<li><a href="the-complex-systems-approach.html#the-complex-systems-approach"><strong>The Complex Systems Approach </strong></a>
<ul>
<li class="chapter" data-level="" data-path="learning-outcomes.html"><a href="learning-outcomes.html"><i class="fa fa-check"></i>Learning outcomes</a>
<ul>
<li class="chapter" data-level="" data-path="learning-outcomes.html"><a href="learning-outcomes.html#level-of-participant"><i class="fa fa-check"></i>Level of participant</a></li>
<li class="chapter" data-level="" data-path="learning-outcomes.html"><a href="learning-outcomes.html#for-whom-are-these-courses-designed"><i class="fa fa-check"></i>For whom are these courses designed?</a></li>
<li class="chapter" data-level="" data-path="learning-outcomes.html"><a href="learning-outcomes.html#admission-requirements"><i class="fa fa-check"></i>Admission requirements</a></li>
</ul></li>
<li><a href="literature.html#literature"><strong>Literature</strong></a>
<ul>
<li class="chapter" data-level="" data-path="literature.html"><a href="literature.html"><i class="fa fa-check"></i>Pre-course literature:</a></li>
<li class="chapter" data-level="" data-path="literature.html"><a href="literature.html#selected-chapters-from-these-books-will-be-made-available-so-you-can-make-a-personal-copy"><i class="fa fa-check"></i>Selected chapters from these books will be made available so you can make a personal copy:</a></li>
<li class="chapter" data-level="" data-path="literature.html"><a href="literature.html#notes-about-this-book-and-the-assignments"><i class="fa fa-check"></i>Notes about this book and the assignments</a></li>
</ul></li>
<li><a href="schedule.html#schedule"><strong>Schedule</strong></a></li>
<li><a href="we-used-r.html#we-used-r"><strong>We used <code>R</code>!</strong></a></li>
</ul></li>
<li class="part"><span><b>I Introduction</b></span></li>
<li class="chapter" data-level="1" data-path="a-quick-guide-to-scientific-rigour.html"><a href="a-quick-guide-to-scientific-rigour.html"><i class="fa fa-check"></i><b>1</b> <strong>A Quick Guide to Scientific Rigour</strong></a>
<ul>
<li class="chapter" data-level="1.1" data-path="rigorous-open-science.html"><a href="rigorous-open-science.html"><i class="fa fa-check"></i><b>1.1</b> Rigorous Open Science</a>
<ul>
<li class="chapter" data-level="" data-path="rigorous-open-science.html"><a href="rigorous-open-science.html#strong-inference"><i class="fa fa-check"></i>Strong Inference</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="theoretical-tunnelvision.html"><a href="theoretical-tunnelvision.html"><i class="fa fa-check"></i><b>1.2</b> Theoretical Tunnelvision</a>
<ul>
<li class="chapter" data-level="" data-path="theoretical-tunnelvision.html"><a href="theoretical-tunnelvision.html#so-whats-wrong"><i class="fa fa-check"></i>So? What’s wrong?</a></li>
<li class="chapter" data-level="" data-path="theoretical-tunnelvision.html"><a href="theoretical-tunnelvision.html#no-such-thing-as-theory-free-facts"><i class="fa fa-check"></i>No such thing as theory-free ‘facts’</a></li>
</ul></li>
<li><a href="study-materials.html#study-materials"><em>Study Materials</em></a>
<ul>
<li class="chapter" data-level="" data-path="study-materials.html"><a href="study-materials.html"><i class="fa fa-check"></i>Phenomena, theories, facts and laws</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-complexity-methods.html"><a href="introduction-to-complexity-methods.html"><i class="fa fa-check"></i><b>2</b> <strong>Introduction to Complexity Methods</strong></a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-complex-systems-approach-1.html"><a href="the-complex-systems-approach-1.html"><i class="fa fa-check"></i><b>2.1</b> The Complex Systems Approach</a></li>
<li class="chapter" data-level="2.2" data-path="ergodicity-and-the-measurment-problem.html"><a href="ergodicity-and-the-measurment-problem.html"><i class="fa fa-check"></i><b>2.2</b> Ergodicity and the Measurment Problem</a></li>
<li class="chapter" data-level="2.3" data-path="component-vs-interaction-dominant-dynamics.html"><a href="component-vs-interaction-dominant-dynamics.html"><i class="fa fa-check"></i><b>2.3</b> Component- vs. Interaction-dominant Dynamics</a></li>
<li class="chapter" data-level="2.4" data-path="a-behavioural-science-of-the-individual.html"><a href="a-behavioural-science-of-the-individual.html"><i class="fa fa-check"></i><b>2.4</b> A Behavioural Science of the Individual?</a></li>
<li><a href="study-materials-and-resources.html#study-materials-and-resources"><em>Study Materials and Resources</em></a>
<ul>
<li class="chapter" data-level="" data-path="study-materials-and-resources.html"><a href="study-materials-and-resources.html"><i class="fa fa-check"></i>Graphical representation of complex system properties</a></li>
<li class="chapter" data-level="" data-path="study-materials-and-resources.html"><a href="study-materials-and-resources.html#the-complexity-explorer-glossary"><i class="fa fa-check"></i>The Complexity Explorer Glossary</a></li>
<li class="chapter" data-level="" data-path="study-materials-and-resources.html"><a href="study-materials-and-resources.html#ted-talks"><i class="fa fa-check"></i>TED talks</a></li>
<li class="chapter" data-level="" data-path="study-materials-and-resources.html"><a href="study-materials-and-resources.html#systems-innovation-videos"><i class="fa fa-check"></i>Systems Innovation videos</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Mathematics of Change</b></span></li>
<li class="chapter" data-level="3" data-path="introduction-to-the-mathematics-of-change.html"><a href="introduction-to-the-mathematics-of-change.html"><i class="fa fa-check"></i><b>3</b> <strong>Introduction to the Mathematics of Change</strong></a>
<ul>
<li class="chapter" data-level="3.1" data-path="its-a-line-its-a-plane.html"><a href="its-a-line-its-a-plane.html"><i class="fa fa-check"></i><b>3.1</b> <strong>It’s a line! It’s a plane!</strong></a></li>
<li class="chapter" data-level="3.2" data-path="no-its-a-time-series.html"><a href="no-its-a-time-series.html"><i class="fa fa-check"></i><b>3.2</b> <strong>No! … It’s a time series!</strong></a></li>
<li class="chapter" data-level="3.3" data-path="implementing-iterative-functions.html"><a href="implementing-iterative-functions.html"><i class="fa fa-check"></i><b>3.3</b> <strong>Implementing iterative functions</strong></a></li>
<li class="chapter" data-level="3.4" data-path="numerical-integration-to-simulate-continuous-time.html"><a href="numerical-integration-to-simulate-continuous-time.html"><i class="fa fa-check"></i><b>3.4</b> <strong>Numerical integration to simulate continuous time</strong></a>
<ul>
<li class="chapter" data-level="" data-path="numerical-integration-to-simulate-continuous-time.html"><a href="numerical-integration-to-simulate-continuous-time.html#eulers-method-and-more"><i class="fa fa-check"></i>Euler’s method and more…</a></li>
<li class="chapter" data-level="" data-path="numerical-integration-to-simulate-continuous-time.html"><a href="numerical-integration-to-simulate-continuous-time.html#analytical-solution"><i class="fa fa-check"></i>Analytical solution</a></li>
<li class="chapter" data-level="" data-path="numerical-integration-to-simulate-continuous-time.html"><a href="numerical-integration-to-simulate-continuous-time.html#numerical-solution-discrete"><i class="fa fa-check"></i>Numerical solution (discrete)</a></li>
<li class="chapter" data-level="3.4.1" data-path="numerical-integration-to-simulate-continuous-time.html"><a href="numerical-integration-to-simulate-continuous-time.html#euler-vs.-runge-kutta"><i class="fa fa-check"></i><b>3.4.1</b> Euler vs. Runge-Kutta</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="deterministic-chaos.html"><a href="deterministic-chaos.html"><i class="fa fa-check"></i><b>3.5</b> <strong>Deterministic Chaos</strong></a></li>
<li class="chapter" data-level="3.6" data-path="advmodels.html"><a href="advmodels.html"><i class="fa fa-check"></i><b>3.6</b> <strong>Modeling interactions between processes and agents</strong></a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="advmodels.html"><a href="advmodels.html#the-competetive-lottka-volterra-equations"><i class="fa fa-check"></i><b>3.6.1</b> The Competetive Lottka-Volterra Equations</a></li>
<li class="chapter" data-level="3.6.2" data-path="advmodels.html"><a href="advmodels.html#predator-prey-and-other-dynamics-as-agent-based-models"><i class="fa fa-check"></i><b>3.6.2</b> Predator-Prey (and other) dynamics as Agent Based Models</a></li>
<li class="chapter" data-level="3.6.3" data-path="advmodels.html"><a href="advmodels.html#the-dynamic-field-model"><i class="fa fa-check"></i><b>3.6.3</b> The dynamic field model</a></li>
</ul></li>
<li><a href="study-materials-and-resources-1.html#study-materials-and-resources-1"><em>Study Materials and Resources</em></a>
<ul>
<li class="chapter" data-level="3.6.4" data-path="study-materials-and-resources-1.html"><a href="study-materials-and-resources-1.html"><i class="fa fa-check"></i><b>3.6.4</b> Differential equations</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Basic (Nonlinear) Time Series Analysis</b></span></li>
<li class="chapter" data-level="4" data-path="basic-time-series-analysis.html"><a href="basic-time-series-analysis.html"><i class="fa fa-check"></i><b>4</b> <strong>Basic Time Series Analysis</strong></a>
<ul>
<li class="chapter" data-level="4.1" data-path="always-plot-your-data.html"><a href="always-plot-your-data.html"><i class="fa fa-check"></i><b>4.1</b> <strong>Always plot your data!</strong></a></li>
<li class="chapter" data-level="4.2" data-path="correlation-functions.html"><a href="correlation-functions.html"><i class="fa fa-check"></i><b>4.2</b> <strong>Correlation Functions</strong></a></li>
<li class="chapter" data-level="4.3" data-path="autoregressive-models.html"><a href="autoregressive-models.html"><i class="fa fa-check"></i><b>4.3</b> <strong>Autoregressive models</strong></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="basic-nonlinear-time-series-analysis.html"><a href="basic-nonlinear-time-series-analysis.html"><i class="fa fa-check"></i><b>5</b> <strong>Basic Nonlinear Time Series Analysis</strong></a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="basic-nonlinear-time-series-analysis.html"><a href="basic-nonlinear-time-series-analysis.html#intuitive-notion-of-fractal-dimension"><i class="fa fa-check"></i><b>5.0.1</b> <strong>Intuitive notion of Fractal Dimension</strong></a></li>
<li class="chapter" data-level="5.0.2" data-path="basic-nonlinear-time-series-analysis.html"><a href="basic-nonlinear-time-series-analysis.html#coloured-noise"><i class="fa fa-check"></i><b>5.0.2</b> <strong>Coloured noise</strong></a></li>
<li class="chapter" data-level="5.1" data-path="relative-roughness.html"><a href="relative-roughness.html"><i class="fa fa-check"></i><b>5.1</b> <strong>Relative Roughness</strong></a></li>
<li class="chapter" data-level="5.2" data-path="entropy.html"><a href="entropy.html"><i class="fa fa-check"></i><b>5.2</b> <strong>Entropy</strong></a>
<ul>
<li class="chapter" data-level="" data-path="entropy.html"><a href="entropy.html#physical-information-and-entropy"><i class="fa fa-check"></i>Physical Information and Entropy</a></li>
<li class="chapter" data-level="" data-path="entropy.html"><a href="entropy.html#entropy-in-time-series"><i class="fa fa-check"></i>Entropy in time series</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="other-measures-in-casnet.html"><a href="other-measures-in-casnet.html"><i class="fa fa-check"></i><b>5.3</b> <strong>Other measures in <em>casnet</em></strong></a></li>
<li><a href="study-materials-and-resources-2.html#study-materials-and-resources-2"><em>Study Materials and Resources</em></a>
<ul>
<li class="chapter" data-level="" data-path="study-materials-and-resources-2.html"><a href="study-materials-and-resources-2.html"><i class="fa fa-check"></i>Notes on Entropy</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Scaling Phenomena - Fluctuation Analyses</b></span></li>
<li class="chapter" data-level="6" data-path="fluctuation-analyses-global-scaling.html"><a href="fluctuation-analyses-global-scaling.html"><i class="fa fa-check"></i><b>6</b> <strong>Fluctuation Analyses: Global Scaling</strong></a>
<ul>
<li class="chapter" data-level="6.1" data-path="power-spectral-density-psd-slope.html"><a href="power-spectral-density-psd-slope.html"><i class="fa fa-check"></i><b>6.1</b> <strong>Power Spectral Density (PSD) slope</strong></a></li>
<li class="chapter" data-level="6.2" data-path="standardised-dispersion-analysis-sda.html"><a href="standardised-dispersion-analysis-sda.html"><i class="fa fa-check"></i><b>6.2</b> <strong>Standardised Dispersion Analysis (SDA)</strong></a></li>
<li class="chapter" data-level="6.3" data-path="detrended-fluctuation-analysis-dfa.html"><a href="detrended-fluctuation-analysis-dfa.html"><i class="fa fa-check"></i><b>6.3</b> <strong>Detrended Fluctuation Analysis (DFA)</strong></a></li>
<li class="chapter" data-level="6.4" data-path="other-varieties-of-fluctuation-analysis.html"><a href="other-varieties-of-fluctuation-analysis.html"><i class="fa fa-check"></i><b>6.4</b> <strong>Other varieties of fluctuation analysis</strong></a></li>
<li><a href="study-materials-and-resources-3.html#study-materials-and-resources-3"><em>Study Materials and Resources</em></a>
<ul>
<li class="chapter" data-level="" data-path="study-materials-and-resources-3.html"><a href="study-materials-and-resources-3.html"><i class="fa fa-check"></i>Systems Innovation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="fluctuation-analyses-local-scaling.html"><a href="fluctuation-analyses-local-scaling.html"><i class="fa fa-check"></i><b>7</b> <strong>Fluctuation Analyses: Local Scaling</strong></a>
<ul>
<li class="chapter" data-level="7.1" data-path="multi-fractal-geometry-in-time-series.html"><a href="multi-fractal-geometry-in-time-series.html"><i class="fa fa-check"></i><b>7.1</b> <strong>Multi-fractal geometry in time series</strong></a></li>
<li class="chapter" data-level="7.2" data-path="multi-fractal-dfa.html"><a href="multi-fractal-dfa.html"><i class="fa fa-check"></i><b>7.2</b> <strong>Multi-fractal DFA</strong></a></li>
<li class="chapter" data-level="7.3" data-path="the-wavelet-transform-modulus-maxima-wtmm.html"><a href="the-wavelet-transform-modulus-maxima-wtmm.html"><i class="fa fa-check"></i><b>7.3</b> <strong>The Wavelet Transform Modulus Maxima (WTMM)</strong></a></li>
<li class="chapter" data-level="7.4" data-path="multi-fractal-spectrum-measures.html"><a href="multi-fractal-spectrum-measures.html"><i class="fa fa-check"></i><b>7.4</b> <strong>Multi-fractal Spectrum Measures</strong></a></li>
</ul></li>
<li class="part"><span><b>V Recurrence Quantification Analysis</b></span></li>
<li class="chapter" data-level="8" data-path="auto-rqa-categorical-data.html"><a href="auto-rqa-categorical-data.html"><i class="fa fa-check"></i><b>8</b> <strong>Auto-RQA: Categorical Data</strong></a>
<ul>
<li class="chapter" data-level="8.1" data-path="human-random-number-generators.html"><a href="human-random-number-generators.html"><i class="fa fa-check"></i><b>8.1</b> <strong>Human Random Number Generators</strong></a></li>
<li class="chapter" data-level="8.2" data-path="hypothesis-testing-using-constrained-data-realisations.html"><a href="hypothesis-testing-using-constrained-data-realisations.html"><i class="fa fa-check"></i><b>8.2</b> <strong>Hypothesis testing using constrained data realisations</strong></a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="hypothesis-testing-using-constrained-data-realisations.html"><a href="hypothesis-testing-using-constrained-data-realisations.html#a-permutation-test-with-surrogate-time-series"><i class="fa fa-check"></i><b>8.2.1</b> A permutation test with surrogate time series</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="auto-rqa-continuous-data.html"><a href="auto-rqa-continuous-data.html"><i class="fa fa-check"></i><b>9</b> <strong>Auto-RQA: Continuous Data</strong></a>
<ul>
<li class="chapter" data-level="9.1" data-path="phase-space-reconstruction.html"><a href="phase-space-reconstruction.html"><i class="fa fa-check"></i><b>9.1</b> Phase Space Reconstruction</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="phase-space-reconstruction.html"><a href="phase-space-reconstruction.html#choosing-an-embedding-lag"><i class="fa fa-check"></i><b>9.1.1</b> Choosing an embedding lag</a></li>
<li class="chapter" data-level="9.1.2" data-path="phase-space-reconstruction.html"><a href="phase-space-reconstruction.html#false-nearest-neighbor-analysis"><i class="fa fa-check"></i><b>9.1.2</b> False Nearest Neighbor analysis</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="from-distance-matrix-to-recurrence-plot.html"><a href="from-distance-matrix-to-recurrence-plot.html"><i class="fa fa-check"></i><b>9.2</b> From Distance Matrix to Recurrence Plot</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="notes-on-running-recurrence-quantification-analysis-in-r.html"><a href="notes-on-running-recurrence-quantification-analysis-in-r.html"><i class="fa fa-check"></i><b>10</b> <strong>Notes on running Recurrence Quantification Analysis in R</strong></a>
<ul>
<li class="chapter" data-level="10.1" data-path="casnet.html"><a href="casnet.html"><i class="fa fa-check"></i><b>10.1</b> <strong>casnet</strong></a>
<ul>
<li><a href="casnet.html#an-r-interface-to-marwans-commandline-recurrence-plots"><strong>An R interface to Marwan’s commandline recurrence plots</strong></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="other-options.html"><a href="other-options.html"><i class="fa fa-check"></i><b>10.2</b> <strong>Other options</strong></a></li>
<li class="chapter" data-level="10.3" data-path="computational-load-the-python-solution-pyrqa.html"><a href="computational-load-the-python-solution-pyrqa.html"><i class="fa fa-check"></i><b>10.3</b> <strong>Computational load: The Python solution [PyRQA]</strong></a>
<ul>
<li><a href="computational-load-the-python-solution-pyrqa.html#setup-the-environment"><strong>Setup the environment</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="cross-rqa-categorical-data.html"><a href="cross-rqa-categorical-data.html"><i class="fa fa-check"></i><b>11</b> <strong>Cross-RQA: Categorical Data</strong></a></li>
<li class="chapter" data-level="12" data-path="cross-rqa-continuous-data.html"><a href="cross-rqa-continuous-data.html"><i class="fa fa-check"></i><b>12</b> <strong>Cross-RQA: Continuous Data</strong></a>
<ul>
<li class="chapter" data-level="12.0.1" data-path="cross-rqa-continuous-data.html"><a href="cross-rqa-continuous-data.html#diagonal-recurrence-profiles"><i class="fa fa-check"></i><b>12.0.1</b> Diagonal Recurrence Profiles</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="other-flavours-of-rqa.html"><a href="other-flavours-of-rqa.html"><i class="fa fa-check"></i><b>13</b> <em>Other flavours of RQA</em></a>
<ul>
<li class="chapter" data-level="13.1" data-path="lagged-rqa-sliding-window-analyses.html"><a href="lagged-rqa-sliding-window-analyses.html"><i class="fa fa-check"></i><b>13.1</b> <strong>Lagged RQA: Sliding window analyses</strong></a></li>
<li class="chapter" data-level="13.2" data-path="chromatic-rqa.html"><a href="chromatic-rqa.html"><i class="fa fa-check"></i><b>13.2</b> <strong>Chromatic RQA</strong></a></li>
<li class="chapter" data-level="13.3" data-path="anisotropic-rqa.html"><a href="anisotropic-rqa.html"><i class="fa fa-check"></i><b>13.3</b> <strong>Anisotropic RQA</strong></a></li>
<li class="chapter" data-level="13.4" data-path="multidimensional-rqa.html"><a href="multidimensional-rqa.html"><i class="fa fa-check"></i><b>13.4</b> <strong>Multidimensional RQA</strong></a></li>
<li class="chapter" data-level="13.5" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>13.5</b> <strong>References</strong></a></li>
</ul></li>
<li class="part"><span><b>VI Multivariate Timeseries Analysis</b></span></li>
<li class="chapter" data-level="14" data-path="vector-auto-regression-var.html"><a href="vector-auto-regression-var.html"><i class="fa fa-check"></i><b>14</b> <strong>Vector Auto Regression (VAR)</strong></a></li>
<li class="chapter" data-level="15" data-path="dynamic-complexity.html"><a href="dynamic-complexity.html"><i class="fa fa-check"></i><b>15</b> <strong>Dynamic Complexity</strong></a>
<ul>
<li><a href="study-materials-and-resources-4.html#study-materials-and-resources-4"><em>Study Materials and Resources</em></a>
<ul>
<li class="chapter" data-level="" data-path="study-materials-and-resources-4.html"><a href="study-materials-and-resources-4.html"><i class="fa fa-check"></i>Systems Innovation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="graph-theory-and-complex-network-analysis.html"><a href="graph-theory-and-complex-network-analysis.html"><i class="fa fa-check"></i><b>16</b> <strong>Graph Theory and Complex Network Analysis</strong></a>
<ul>
<li class="chapter" data-level="16.1" data-path="recurrence-networks.html"><a href="recurrence-networks.html"><i class="fa fa-check"></i><b>16.1</b> <strong>Recurrence Networks</strong></a></li>
<li class="chapter" data-level="16.2" data-path="networks-based-on-multidimensional-rqa.html"><a href="networks-based-on-multidimensional-rqa.html"><i class="fa fa-check"></i><b>16.2</b> <strong>Networks based on Multidimensional RQA</strong></a></li>
<li class="chapter" data-level="16.3" data-path="transition-networks.html"><a href="transition-networks.html"><i class="fa fa-check"></i><b>16.3</b> <strong>Transition Networks</strong></a></li>
</ul></li>
<li class="appendix"><span><b>APPENDICES</b></span></li>
<li class="chapter" data-level="A" data-path="some-notes-on-using-r.html"><a href="some-notes-on-using-r.html"><i class="fa fa-check"></i><b>A</b> <strong>Some Notes on Using <code>R</code></strong></a>
<ul>
<li class="chapter" data-level="A.1" data-path="new-to-r.html"><a href="new-to-r.html"><i class="fa fa-check"></i><b>A.1</b> <strong>New to <code>R</code>?</strong></a></li>
<li class="chapter" data-level="A.2" data-path="tutorials.html"><a href="tutorials.html"><i class="fa fa-check"></i><b>A.2</b> <strong>Getting started with <code>R</code> tutorials</strong></a></li>
<li class="chapter" data-level="A.3" data-path="not-new-to-r.html"><a href="not-new-to-r.html"><i class="fa fa-check"></i><b>A.3</b> <strong>Not new to <code>R</code>?</strong></a></li>
<li class="chapter" data-level="A.4" data-path="time-series-analyses-in-r.html"><a href="time-series-analyses-in-r.html"><i class="fa fa-check"></i><b>A.4</b> <strong>Time series analyses in R</strong></a>
<ul>
<li><a href="time-series-analyses-in-r.html#installing-casnet"><strong>Installing casnet</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="plotTS.html"><a href="plotTS.html"><i class="fa fa-check"></i><b>B</b> <strong>Working with time series in R</strong></a>
<ul>
<li class="chapter" data-level="B.1" data-path="plotting-a-ts-object-as-a-time-series.html"><a href="plotting-a-ts-object-as-a-time-series.html"><i class="fa fa-check"></i><b>B.1</b> Plotting a <code>ts</code> object as a time series</a></li>
<li class="chapter" data-level="B.2" data-path="plotting-multiple-time-series-in-one-figure.html"><a href="plotting-multiple-time-series-in-one-figure.html"><i class="fa fa-check"></i><b>B.2</b> Plotting multiple time series in one figure</a></li>
<li class="chapter" data-level="B.3" data-path="the-return-plot.html"><a href="the-return-plot.html"><i class="fa fa-check"></i><b>B.3</b> The return plot</a></li>
<li class="chapter" data-level="B.4" data-path="using-ggplot2.html"><a href="using-ggplot2.html"><i class="fa fa-check"></i><b>B.4</b> Using <code>ggplot2</code></a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="Missing.html"><a href="Missing.html"><i class="fa fa-check"></i><b>C</b> <strong>Dealing with Missing Data</strong></a>
<ul>
<li class="chapter" data-level="" data-path="Missing.html"><a href="Missing.html#data-with-missing-values"><i class="fa fa-check"></i>Data with missing values</a></li>
<li class="chapter" data-level="C.1" data-path="univariate-imputation.html"><a href="univariate-imputation.html"><i class="fa fa-check"></i><b>C.1</b> Univariate imputation</a>
<ul>
<li class="chapter" data-level="" data-path="univariate-imputation.html"><a href="univariate-imputation.html#linear-interpolation"><i class="fa fa-check"></i>Linear interpolation</a></li>
<li class="chapter" data-level="" data-path="univariate-imputation.html"><a href="univariate-imputation.html#kalman-filter"><i class="fa fa-check"></i>Kalman filter</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="multiple-imputation.html"><a href="multiple-imputation.html"><i class="fa fa-check"></i><b>C.2</b> Multiple imputation</a>
<ul>
<li class="chapter" data-level="" data-path="multiple-imputation.html"><a href="multiple-imputation.html#auto-select-method"><i class="fa fa-check"></i>Auto-select method</a></li>
<li class="chapter" data-level="" data-path="multiple-imputation.html"><a href="multiple-imputation.html#classification-regression-trees"><i class="fa fa-check"></i>Classification &amp; regression trees</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="compare-different-imputation-methods.html"><a href="compare-different-imputation-methods.html"><i class="fa fa-check"></i><b>C.3</b> Compare different imputation methods</a>
<ul>
<li class="chapter" data-level="" data-path="compare-different-imputation-methods.html"><a href="compare-different-imputation-methods.html#visual-inspection"><i class="fa fa-check"></i>Visual inspection</a></li>
<li class="chapter" data-level="" data-path="compare-different-imputation-methods.html"><a href="compare-different-imputation-methods.html#effect-on-analysis-results"><i class="fa fa-check"></i>Effect on analysis results</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="Terms.html"><a href="Terms.html"><i class="fa fa-check"></i><b>D</b> <strong>List of terms</strong></a>
<ul>
<li><a href="Terms.html#Adap1"><strong>Adaptive Behaviour</strong></a></li>
<li><a href="Terms.html#Anal2"><strong>Analytic solution</strong></a></li>
<li><a href="Terms.html#Attr3"><strong>Attractor</strong></a></li>
<li><a href="Terms.html#Basi4"><strong>Basin of attraction</strong></a></li>
<li><a href="Terms.html#Beha5"><strong>Behaviour (of a dynamic system)</strong></a></li>
<li><a href="Terms.html#Bifu6"><strong>Bifurcation</strong></a></li>
<li><a href="Terms.html#Bifu7"><strong>Bifurcation diagram</strong></a></li>
<li><a href="Terms.html#Cata8"><strong>Catastrophe flags</strong></a></li>
<li><a href="Terms.html#Cata9"><strong>Catastrophe theory</strong></a></li>
<li><a href="Terms.html#Comp10"><strong>Complex Network</strong></a></li>
<li><a href="Terms.html#Comp11"><strong>Complex system</strong></a></li>
<li><a href="Terms.html#Comp12"><strong>Complexity science</strong></a></li>
<li><a href="Terms.html#Comp13"><strong>Component dominant dynamics</strong></a></li>
<li><a href="Terms.html#Cont14"><strong>Control parameter</strong></a></li>
<li><a href="Terms.html#Crit15"><strong>Critical fluctuations</strong></a></li>
<li><a href="Terms.html#Crit16"><strong>Critical slowing down</strong></a></li>
<li><a href="Terms.html#Dete17"><strong>Deterministic Chaos</strong></a></li>
<li><a href="Terms.html#Diff18"><strong>Difference equation</strong></a></li>
<li><a href="Terms.html#Diff19"><strong>Differential equation</strong></a></li>
<li><a href="Terms.html#Dime20"><strong>Dimension</strong></a></li>
<li><a href="Terms.html#Dime21"><strong>Dimensions of a system</strong></a></li>
<li><a href="Terms.html#Dyna22"><strong>Dynamic system</strong></a></li>
<li><a href="Terms.html#Earl23"><strong>Early warning signals</strong></a></li>
<li><a href="Terms.html#Effe24"><strong>Effective Complexity</strong></a></li>
<li><a href="Terms.html#Embe25"><strong>Embedding Dimension</strong></a></li>
<li><a href="Terms.html#Emer26"><strong>Emergence</strong></a></li>
<li><a href="Terms.html#Entr27"><strong>Entropy</strong></a></li>
<li><a href="Terms.html#Epig28"><strong>Epigenetic landscape (potential landscape)</strong></a></li>
<li><a href="Terms.html#Expe29"><strong>Experienced event</strong></a></li>
<li><a href="Terms.html#flow30"><strong>flow ~</strong></a></li>
<li><a href="Terms.html#Frac31"><strong>Fractal</strong></a></li>
<li><a href="Terms.html#Frac32"><strong>Fractal Dimension</strong></a></li>
<li><a href="Terms.html#Grap33"><strong>Graph theory</strong></a></li>
<li><a href="Terms.html#Haus34"><strong>Hausdorff Dimension</strong></a></li>
<li><a href="Terms.html#Holi35"><strong>Holism (epistemic)</strong></a></li>
<li><a href="Terms.html#Idio36"><strong>Idiographic approach</strong></a></li>
<li><a href="Terms.html#Info37"><strong>Information (quantity)</strong></a></li>
<li><a href="Terms.html#Init38"><strong>Initial condition</strong></a></li>
<li><a href="Terms.html#Inte39"><strong>Interaction dominant dynamics</strong></a></li>
<li><a href="Terms.html#Iter40"><strong>Iteration</strong></a></li>
<li><a href="Terms.html#Iter41"><strong>Iterative function</strong></a></li>
<li><a href="Terms.html#Iter42"><strong>Iterative system</strong></a></li>
<li><a href="Terms.html#Larg43"><strong>Largest Lyapunov exponent</strong></a></li>
<li><a href="Terms.html#Limi44"><strong>Limit cycle</strong></a></li>
<li><a href="Terms.html#Limi45"><strong>Limit points</strong></a></li>
<li><a href="Terms.html#Line46"><strong>Linear function of predictors</strong></a></li>
<li><a href="Terms.html#Line47"><strong>Linear function of time</strong></a></li>
<li><a href="Terms.html#map48"><strong>map …</strong></a></li>
<li><a href="Terms.html#Nonl49"><strong>Nonlinear dynamics</strong></a></li>
<li><a href="Terms.html#Orbi50"><strong>Orbit (trajectory)</strong></a></li>
<li><a href="Terms.html#Orde51"><strong>Order</strong></a></li>
<li><a href="Terms.html#Orde52"><strong>Order Parameter</strong></a></li>
<li><a href="Terms.html#Peri53"><strong>Period-doubling</strong></a></li>
<li><a href="Terms.html#Phas54"><strong>Phase portrait</strong></a></li>
<li><a href="Terms.html#Phas55"><strong>Phase space</strong></a></li>
<li><a href="Terms.html#Phas56"><strong>Phase transition</strong></a></li>
<li><a href="Terms.html#Pote57"><strong>Potential function</strong></a></li>
<li><a href="Terms.html#Powe58"><strong>Power-law scaling</strong></a></li>
<li><a href="Terms.html#Recu59"><strong>Recursive process</strong></a></li>
<li><a href="Terms.html#Rela60"><strong>Relaxation time</strong></a></li>
<li><a href="Terms.html#Repe61"><strong>Repellors</strong></a></li>
<li><a href="Terms.html#Retu62"><strong>Return map</strong></a></li>
<li><a href="Terms.html#Sadd63"><strong>Saddle point</strong></a></li>
<li><a href="Terms.html#Scal64"><strong>Scale free network</strong></a></li>
<li><a href="Terms.html#Self65"><strong>Self-affinity</strong></a></li>
<li><a href="Terms.html#Self66"><strong>Self-similarity</strong></a></li>
<li><a href="Terms.html#Sens67"><strong>Sensitive dependence on initial conditions</strong></a></li>
<li><a href="Terms.html#Smal68"><strong>Small world network</strong></a></li>
<li><a href="Terms.html#Stat69"><strong>State</strong></a></li>
<li><a href="Terms.html#Stat70"><strong>State space</strong></a></li>
<li><a href="Terms.html#Stat71"><strong>State space (phase space)</strong></a></li>
<li><a href="Terms.html#Stra72"><strong>Strange attractor</strong></a></li>
<li><a href="Terms.html#Syst73"><strong>System</strong></a></li>
<li><a href="Terms.html#Time74"><strong>Time series</strong></a></li>
<li><a href="Terms.html#Traj75"><strong>Trajectory (orbit)</strong></a></li>
<li><a href="Terms.html#Tran76"><strong>Transient time (transient behaviour)</strong></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-2.html"><a href="references-2.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Complex Systems Approach to Behavioural Science</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="numerical-integration-to-simulate-continuous-time" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> <strong>Numerical integration to simulate continuous time</strong></h2>
<p>In order to ‘solve’ a differential equation for continuous time using a method of numerical integration, one could code it like in the spreadsheet assignment below. For <code>R</code> and <code>Matlab</code> there are so-called <em>solvers</em> available, functions that will do the integration for you. For <code>R</code> look at the <a href="http://desolve.r-forge.r-project.org">Examples in package <code>deSolve</code></a>.</p>
<div id="eulers-method-and-more" class="section level3 unnumbered">
<h3>Euler’s method and more…</h3>
<p>The result of applying a method of numerical integration is called a <strong>numerical solution</strong> of the differential equation. The <strong>analytical solution</strong> is the equation which will give you a value of <span class="math inline">\(Y\)</span> for any point in time, given an initial value <span class="math inline">\(Y_0\)</span>. Systems which have an analytical solution can be used to test the accuracy of <strong>numerical solutions</strong>.</p>
</div>
<div id="analytical-solution" class="section level3 unnumbered">
<h3>Analytical solution</h3>
<p>Remember that the analytical solution for the logistic equation is:</p>
<p><span class="math display">\[
Y(t)  =  \frac{K * Y_0}{Y_0 + \left(K - Y_0 \right) * e^{-r*t} }
\]</span>
This can be ‘simplified’ to</p>
<p><span class="math display">\[
Y(t)  =  \frac{K}{1 + \left(\frac{K}{Y_0-1} \right) * e^{-r*t} }
\]</span></p>
<p>If we want to know the growth level <span class="math inline">\(Y_t\)</span> at <span class="math inline">\(t=10\)</span>, with <span class="math inline">\(Y_0=.0001\)</span>, <span class="math inline">\(r=1.1\)</span> and <span class="math inline">\(K=4\)</span>, we can just <code>fill it in</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="numerical-integration-to-simulate-continuous-time.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a function for the solution</span></span>
<span id="cb4-2"><a href="numerical-integration-to-simulate-continuous-time.html#cb4-2" aria-hidden="true" tabindex="-1"></a>logSol <span class="ot">&lt;-</span> <span class="cf">function</span>(Y0, r, K, t){K<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>(K<span class="sc">/</span>Y0<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>r<span class="sc">*</span>t))}</span>
<span id="cb4-3"><a href="numerical-integration-to-simulate-continuous-time.html#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="numerical-integration-to-simulate-continuous-time.html#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Call the function</span></span>
<span id="cb4-5"><a href="numerical-integration-to-simulate-continuous-time.html#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">logSol</span>(<span class="at">Y0=</span>.<span class="dv">0001</span>, <span class="at">r=</span><span class="fl">1.1</span>, <span class="at">K=</span><span class="dv">4</span>, <span class="at">t=</span><span class="dv">10</span>)</span></code></pre></div>
<pre><code>&gt; [1] 2.398008</code></pre>
<p>We can pass a vector of time points to create the exact solution, the same we would get if we were to iterate the differential/difference equation.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="numerical-integration-to-simulate-continuous-time.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot from t=1 to t=100</span></span>
<span id="cb6-2"><a href="numerical-integration-to-simulate-continuous-time.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">logSol</span>(<span class="at">Y0=</span>.<span class="dv">0001</span>, <span class="at">r=</span><span class="fl">1.1</span>, <span class="at">K=</span><span class="dv">4</span>, <span class="at">t=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>)), <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, </span>
<span id="cb6-3"><a href="numerical-integration-to-simulate-continuous-time.html#cb6-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(Y[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>)</span>
<span id="cb6-4"><a href="numerical-integration-to-simulate-continuous-time.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot t=10 in red</span></span>
<span id="cb6-5"><a href="numerical-integration-to-simulate-continuous-time.html#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">10</span>,<span class="fu">logSol</span>(<span class="at">Y0=</span>.<span class="dv">0001</span>, <span class="at">r=</span><span class="fl">1.1</span>, <span class="at">K=</span><span class="dv">4</span>, <span class="at">t=</span><span class="dv">10</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="CSA-Book_files/figure-html/unnamed-chunk-11-1.png" width="99%" style="display: block; margin: auto;" /></p>
</div>
<div id="numerical-solution-discrete" class="section level3 unnumbered">
<h3>Numerical solution (discrete)</h3>
<p>If we would iterate the differential equation …</p>
<p><span class="math display">\[
\frac{dY}{dt} = Y_t * (1 + r - r * \frac{Y_t}{K})
\]</span></p>
<p>… as if it were a difference equation, we are <em>not</em> simulating continuous time, but a discrete time version of the model:</p>
<p><span class="math display">\[
Y_{i+1} = Y_i * (1 + r - r * \frac{Y_i}{K})
\]</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="numerical-integration-to-simulate-continuous-time.html#cb7-1" aria-hidden="true" tabindex="-1"></a>logIter <span class="ot">&lt;-</span>  <span class="cf">function</span>(Y0,r,K,t){</span>
<span id="cb7-2"><a href="numerical-integration-to-simulate-continuous-time.html#cb7-2" aria-hidden="true" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="fu">length</span>(t)</span>
<span id="cb7-3"><a href="numerical-integration-to-simulate-continuous-time.html#cb7-3" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(Y0, <span class="fu">rep</span>(<span class="cn">NA</span>,N<span class="dv">-2</span>)))</span>
<span id="cb7-4"><a href="numerical-integration-to-simulate-continuous-time.html#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span>(<span class="fu">seq_along</span>(Y), <span class="cf">function</span>(t){ Y[[t<span class="sc">+</span><span class="dv">1</span>]] <span class="ot">&lt;&lt;-</span> Y[t] <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> r <span class="sc">-</span> r <span class="sc">*</span> Y[t] <span class="sc">/</span> K)})</span>
<span id="cb7-5"><a href="numerical-integration-to-simulate-continuous-time.html#cb7-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-6"><a href="numerical-integration-to-simulate-continuous-time.html#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="numerical-integration-to-simulate-continuous-time.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot from t=1 to t=100</span></span>
<span id="cb7-8"><a href="numerical-integration-to-simulate-continuous-time.html#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">logIter</span>(<span class="at">Y0=</span>.<span class="dv">0001</span>, <span class="at">r=</span><span class="fl">1.1</span>, <span class="at">K=</span><span class="dv">4</span>, <span class="at">t=</span><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">20</span>)), <span class="at">type =</span> <span class="st">&quot;b&quot;</span>, </span>
<span id="cb7-9"><a href="numerical-integration-to-simulate-continuous-time.html#cb7-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="fu">expression</span>(Y[t]), <span class="at">xlab =</span> <span class="st">&quot;t&quot;</span>)</span>
<span id="cb7-10"><a href="numerical-integration-to-simulate-continuous-time.html#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot t=10 in red</span></span>
<span id="cb7-11"><a href="numerical-integration-to-simulate-continuous-time.html#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">10</span>,<span class="fu">logSol</span>(<span class="at">Y0=</span>.<span class="dv">0001</span>, <span class="at">r=</span><span class="fl">1.1</span>, <span class="at">K=</span><span class="dv">4</span>, <span class="at">t=</span><span class="dv">10</span>), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div>
<p><img src="CSA-Book_files/figure-html/unnamed-chunk-12-1.png" width="99%" style="display: block; margin: auto;" /></p>
</div>
<div id="euler-vs.-runge-kutta" class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Euler vs. Runge-Kutta</h3>
<p>The method developped by Runge and Kutta takes a harmonic mean over a number of points, R-K4 takes 4 points, R-K6 takes 6, <a href="https://en.wikipedia.org/wiki/Runge–Kutta_methods">but there are many more variants</a>.</p>
<p>Here’s an exampkle with <strong>Predator-Prey dynamics</strong> comparing Euler’s method to R-K4.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb8-2"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb8-3"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb8-4"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Lotka-Volterra Euler</span></span>
<span id="cb8-6"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-6" aria-hidden="true" tabindex="-1"></a>lvEuler <span class="ot">&lt;-</span> <span class="cf">function</span>(R0,F0,N,a,b,c,d,h){</span>
<span id="cb8-7"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Init vector</span></span>
<span id="cb8-9"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-9" aria-hidden="true" tabindex="-1"></a>  Ra <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(R0, <span class="fu">rep</span>(<span class="cn">NA</span>,N<span class="dv">-1</span>)))</span>
<span id="cb8-10"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-10" aria-hidden="true" tabindex="-1"></a>  Fx <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(F0, <span class="fu">rep</span>(<span class="cn">NA</span>,N<span class="dv">-1</span>)))</span>
<span id="cb8-11"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb8-13"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Euler numerical solution of the predator-prey model</span></span>
<span id="cb8-14"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-14" aria-hidden="true" tabindex="-1"></a>  Ra[t<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> Ra[t] <span class="sc">+</span> (a <span class="sc">-</span> b <span class="sc">*</span> Fx[t]) <span class="sc">*</span> Ra[t] <span class="sc">*</span> h</span>
<span id="cb8-15"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-15" aria-hidden="true" tabindex="-1"></a>  Fx[t<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> Fx[t] <span class="sc">+</span> (c <span class="sc">*</span> Ra[t] <span class="sc">-</span> d) <span class="sc">*</span> Fx[t] <span class="sc">*</span> h</span>
<span id="cb8-16"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-17"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-18"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">time=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">NROW</span>(Ra),<span class="at">Ra=</span>Ra,<span class="at">Fx=</span>Fx,<span class="at">method=</span><span class="st">&quot;Euler&quot;</span>))</span>
<span id="cb8-19"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-20"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-21"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Lotka-Volterra Runge Kutta 4</span></span>
<span id="cb8-22"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-22" aria-hidden="true" tabindex="-1"></a>lvRK4 <span class="ot">&lt;-</span> <span class="cf">function</span>(R0,F0,N,a,b,c,d,h){</span>
<span id="cb8-23"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-24"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Init vector</span></span>
<span id="cb8-25"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-25" aria-hidden="true" tabindex="-1"></a>  Ra <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(R0, <span class="fu">rep</span>(<span class="cn">NA</span>,N<span class="dv">-1</span>)))</span>
<span id="cb8-26"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-26" aria-hidden="true" tabindex="-1"></a>  Fx <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">c</span>(F0, <span class="fu">rep</span>(<span class="cn">NA</span>,N<span class="dv">-1</span>)))</span>
<span id="cb8-27"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N){</span>
<span id="cb8-29"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># RK4 numerical solution of the predator-prey model</span></span>
<span id="cb8-30"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-30" aria-hidden="true" tabindex="-1"></a>  k1_R<span class="ot">=</span>(a <span class="sc">-</span> b <span class="sc">*</span> Fx[t]) <span class="sc">*</span> Ra[t]</span>
<span id="cb8-31"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-31" aria-hidden="true" tabindex="-1"></a>  k1_F<span class="ot">=</span>(c <span class="sc">*</span> Ra[t] <span class="sc">-</span> d) <span class="sc">*</span> Fx[t]</span>
<span id="cb8-32"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-33"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-33" aria-hidden="true" tabindex="-1"></a>  k2_R<span class="ot">=</span>(a <span class="sc">-</span> b <span class="sc">*</span> (Fx[t]<span class="sc">+</span>h<span class="sc">*</span>k1_F<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">*</span> (Ra[t]<span class="sc">+</span>h<span class="sc">*</span>k1_R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb8-34"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-34" aria-hidden="true" tabindex="-1"></a>  k2_F<span class="ot">=</span>(c <span class="sc">*</span> (Ra[t]<span class="sc">+</span>h<span class="sc">*</span>k1_R<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> d) <span class="sc">*</span> (Fx[t]<span class="sc">+</span>h<span class="sc">*</span>k1_F<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb8-35"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-36"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-36" aria-hidden="true" tabindex="-1"></a>  k3_R<span class="ot">=</span>(a <span class="sc">-</span> b <span class="sc">*</span> (Fx[t]<span class="sc">+</span>h<span class="sc">*</span>k2_F<span class="sc">/</span><span class="dv">2</span>)) <span class="sc">*</span> (Ra[t]<span class="sc">+</span>h<span class="sc">*</span>k2_R<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb8-37"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-37" aria-hidden="true" tabindex="-1"></a>  k3_F<span class="ot">=</span>(c <span class="sc">*</span> (Ra[t]<span class="sc">+</span>h<span class="sc">*</span>k2_R<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> d) <span class="sc">*</span> (Fx[t]<span class="sc">+</span>h<span class="sc">*</span>k2_F<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb8-38"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-39"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-39" aria-hidden="true" tabindex="-1"></a>  k4_R<span class="ot">=</span>(a <span class="sc">-</span> b <span class="sc">*</span> (Fx[t]<span class="sc">+</span>h<span class="sc">*</span>k3_F)) <span class="sc">*</span> (Ra[t]<span class="sc">+</span>h<span class="sc">*</span>k3_R)</span>
<span id="cb8-40"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-40" aria-hidden="true" tabindex="-1"></a>  k4_F<span class="ot">=</span>(c <span class="sc">*</span> (Ra[t]<span class="sc">+</span>h<span class="sc">*</span>k3_R) <span class="sc">-</span> d) <span class="sc">*</span> (Fx[t]<span class="sc">+</span>h<span class="sc">*</span>k3_F)</span>
<span id="cb8-41"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-42"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Iterative process</span></span>
<span id="cb8-43"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-43" aria-hidden="true" tabindex="-1"></a>  Ra[t<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> Ra[t] <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)<span class="sc">*</span>h<span class="sc">*</span>(k1_R<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>k2_R<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>k3_R<span class="sc">+</span>k4_R)</span>
<span id="cb8-44"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-44" aria-hidden="true" tabindex="-1"></a>  Fx[t<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> Fx[t] <span class="sc">+</span> (<span class="dv">1</span><span class="sc">/</span><span class="dv">6</span>)<span class="sc">*</span>h<span class="sc">*</span>(k1_F<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>k2_F<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>k3_F<span class="sc">+</span>k4_F)</span>
<span id="cb8-45"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb8-46"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-47"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">time=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">NROW</span>(Ra),<span class="at">Ra=</span>Ra,<span class="at">Fx=</span>Fx,<span class="at">method=</span><span class="st">&quot;RK4&quot;</span>))</span>
<span id="cb8-48"><a href="numerical-integration-to-simulate-continuous-time.html#cb8-48" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now that we have the fuctions, we’ll plot the numerical solutions for the same set of parameters. The continuous mathematics (= if you do some calculations to find the fixed points of the system) ensure us that the system should be in an equilibrium state in which the populations keep going around in the same cycle of growth and collapse. Let’s see what happens…</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb9-2"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-2" aria-hidden="true" tabindex="-1"></a>N  <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb9-3"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Equilibrium</span></span>
<span id="cb9-5"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-5" aria-hidden="true" tabindex="-1"></a>a  <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">6</span></span>
<span id="cb9-6"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-6" aria-hidden="true" tabindex="-1"></a>b  <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">/</span><span class="dv">3</span></span>
<span id="cb9-7"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-7" aria-hidden="true" tabindex="-1"></a>c  <span class="ot">&lt;-</span> d  <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-8"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-8" aria-hidden="true" tabindex="-1"></a>R0 <span class="ot">&lt;-</span> F0 <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb9-9"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Time constant</span></span>
<span id="cb9-11"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-11" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb9-12"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the results</span></span>
<span id="cb9-14"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-14" aria-hidden="true" tabindex="-1"></a>pp1 <span class="ot">&lt;-</span> <span class="fu">lvEuler</span>(R0,F0,N,a,b,c,d,h)</span>
<span id="cb9-15"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-15" aria-hidden="true" tabindex="-1"></a>pp2 <span class="ot">&lt;-</span> <span class="fu">lvRK4</span>(R0,F0,N,a,b,c,d,h)</span>
<span id="cb9-16"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-17"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Make a long dataframe</span></span>
<span id="cb9-18"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-18" aria-hidden="true" tabindex="-1"></a>pp <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pp1,pp2)</span>
<span id="cb9-19"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-20" aria-hidden="true" tabindex="-1"></a>pp.long <span class="ot">&lt;-</span> pp <span class="sc">%&gt;%</span></span>
<span id="cb9-21"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(<span class="at">key =</span> TimeSeries, <span class="at">value =</span> Y, <span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;time&quot;</span>,<span class="st">&quot;method&quot;</span>))</span>
<span id="cb9-22"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Time series plots</span></span>
<span id="cb9-24"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pp.long, <span class="fu">aes</span>(<span class="at">x=</span>time,<span class="at">y=</span>Y,<span class="at">colour=</span>TimeSeries)) <span class="sc">+</span></span>
<span id="cb9-25"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb9-26"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(method<span class="sc">~</span>.) <span class="sc">+</span></span>
<span id="cb9-27"><a href="numerical-integration-to-simulate-continuous-time.html#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="CSA-Book_files/figure-html/unnamed-chunk-14-1.png" width="99%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="numerical-integration-to-simulate-continuous-time.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Phase plane plots</span></span>
<span id="cb10-2"><a href="numerical-integration-to-simulate-continuous-time.html#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pp, <span class="fu">aes</span>(<span class="at">x=</span>Ra,<span class="at">y=</span>Fx,<span class="at">colour=</span>time)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="numerical-integration-to-simulate-continuous-time.html#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span></span>
<span id="cb10-4"><a href="numerical-integration-to-simulate-continuous-time.html#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(method<span class="sc">~</span>.) <span class="sc">+</span></span>
<span id="cb10-5"><a href="numerical-integration-to-simulate-continuous-time.html#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Rabbits&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Foxes&quot;</span>) <span class="sc">+</span></span>
<span id="cb10-6"><a href="numerical-integration-to-simulate-continuous-time.html#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="CSA-Book_files/figure-html/unnamed-chunk-14-2.png" width="99%" style="display: block; margin: auto;" /></p>
<p>Using the Euler method predator and prey populations do not ‘die out,’ but in phase space they seem to occupy different behavioural regimes. This looks like an unstable periodic orbit, or an unstable limit cycle, but it is in fact caused by the inaccuarcy of Euler’s method. Here <em>RK4</em> clearly outperforms <em>Euler</em>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="implementing-iterative-functions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="deterministic-chaos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
